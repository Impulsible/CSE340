<nav class="main-nav" aria-label="Main navigation">
  <ul class="nav-list">

    <% 
      // Define links and their active state
      const links = [
        { href: '/', label: 'Home', active: title && title.startsWith('CSE Motors') },
        { href: '/custom', label: 'Custom Shop (All Vehicles)', active: title && title.startsWith('Custom') },
        { href: '/sport', label: 'Sport Cars', active: title && title.startsWith('Sport') },
        { href: '/suv', label: 'SUVs', active: title && title.startsWith('SUV') },
        { href: '/sedan', label: 'Sedans', active: title && title.startsWith('Sedan') },
        { href: '/truck', label: 'Trucks', active: title && title.startsWith('Truck') },
        { href: '/account', label: 'Account', active: title && title.startsWith('My Account') }
      ];
    %>

    <% links.forEach(link => { %>
      <li>
        <a href="<%= link.href %>" 
           <%= link.active ? 'class="current-page" aria-current="page"' : '' %>>
          <%= link.label %>
        </a>
      </li>
    <% }) %>

    <!-- Assignment Testing Dropdown -->
    <li class="nav-dropdown">
      <button class="nav-dropdown-toggle" aria-expanded="false" aria-controls="testing-menu">
        Testing â–¼
      </button>
      <ul class="nav-dropdown-menu" id="testing-menu">
        <li><a href="/debug-db">Debug Database</a></li>
        <li><a href="/debug-vehicle/1">Test Vehicle #1</a></li>
        <li><a href="/trigger-error">Test Error Handling</a></li>
      </ul>
    </li>

  </ul>
</nav>

<script>
  // Dropdown toggle functionality
  document.querySelectorAll('.nav-dropdown-toggle').forEach(button => {
    button.addEventListener('click', (e) => {
      e.stopPropagation();
      const expanded = button.getAttribute('aria-expanded') === 'true';
      button.setAttribute('aria-expanded', !expanded);
      
      const menu = document.getElementById(button.getAttribute('aria-controls'));
      if (menu) {
        menu.style.display = expanded ? 'none' : 'block';
      }
    });
  });

  // Close dropdowns when clicking outside
  document.addEventListener('click', () => {
    document.querySelectorAll('.nav-dropdown-menu').forEach(menu => {
      menu.style.display = 'none';
    });
    document.querySelectorAll('.nav-dropdown-toggle').forEach(button => {
      button.setAttribute('aria-expanded', 'false');
    });
  });
</script>